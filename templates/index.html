<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Glass Quality Checker</title>
</head>
<body>
    <h1>🧠 Glass Quality Checker</h1>

    <form method="POST" enctype="multipart/form-data">
        <p><strong>上传包含 OK_NG 标签的 CSV 文件：</strong></p>
        <input type="file" name="csv_file" required>
        <button type="submit">上传训练模型</button>
    </form>

    <hr>

    {% if message %}
        <p>{{ message }}</p>
    {% endif %}

    {% if features %}
        <form method="POST">
            <p><strong>请输入各参数预测：</strong></p>
            {% for f in features %}
                <label>{{ f }}:</label>
                <input type="number" step="any" name="{{ f }}" required><br>
            {% endfor %}
            <button type="submit">预测合格与否</button>
        </form>
    {% endif %}

    {% if result %}
        <h2>预测结果：{{ result }}</h2>
        <p>预测概率 (为 OK 的概率)：{{ prob | round(4) }}</p>
    {% endif %}

    {% if shap_plot %}
        <h3>📊 SHAP 可解释性分析图：</h3>
        <img src="data:image/png;base64,{{ shap_plot }}" alt="SHAP Plot">
    {% endif %}
</body>
</html>
